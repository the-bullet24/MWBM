<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:pe="http://primefaces.org/ui/extensions" 
	template="plantilla/plantilla.xhtml">
	<ui:define name="metadata">
	</ui:define>
		<ui:define name="content">
		<h:form id="formTablas">
			<p:defaultCommand target="mgin1" />
			<p:commandButton value="MGIN" id="mgin1" process="@this"  style="display: none;"  ></p:commandButton>
			<p:growl id="msjGeneracion"/>
			<p:growl id="msjGeneracion2" globalOnly="true" />
			<p:panelGrid>
				<p:row>
					<p:column>
						<p:outputLabel value="Nombre de Tabla" style=" font-weight: bold; "></p:outputLabel>
					</p:column>
					<p:column> 
						<p:selectOneMenu id="tipoNombreTabla" label="cmbNombreTabla" value="#{bMantenimientoTablas.mMantenimientoTablas.tablaSeleccionada}"  
										  requiredMessage="Seleccione una tabla vÃ¡lida" required="true">
							<p:ajax event="change" listener="#{bMantenimientoTablas.listarParametros}" update="formTablas"></p:ajax>
							<f:selectItem itemValue="#{null}" itemLabel="SELECCIONE TIPO DE TABLA"></f:selectItem>
							<f:selectItems value="#{bMantenimientoTablas.listaNombres}" var ="parametro" itemValue="#{parametro.ctabla}" itemLabel="#{parametro.valor}" ></f:selectItems>
						</p:selectOneMenu>
					</p:column>
				</p:row>
			</p:panelGrid>
			<br/>
 			<p:panel id="panelParametros" styleClass="content" header = "#{bMantenimientoTablas.titulo}"> 
				<br/>
					<div align="right">
						<p:commandButton  value="Nuevo Registro" action="#{bMantenimientoTablas.limpiarDialog}" oncomplete="PF('dlg1').show();"
								 process="@this" update="dialogMantenimientoTablas"
								rendered="#{(not empty bMantenimientoTablas.mMantenimientoTablas.tablaSeleccionada and bMantenimientoTablas.mMantenimientoTablas.activarAgregar eq '1' ? true:false)}">
								<p:resetInput target="dialogMantenimientoTablas" />
						</p:commandButton>
					</div>				
				<br/>	
				<p:dataTable	
					value="#{bMantenimientoTablas.listaParametro}"  var="parametroTabla" styleClass="tablaParametro" id="tablaParametro1"
							editable="true" style="width: 100%" emptyMessage="No hay datos disponibles" widgetVar="wvParameterTable">					
						
					<p:ajax event="rowEdit" listener="#{bMantenimientoTablas.onRowEdit}" update=":formTablas:tablaParametro1 :formTablas:msjGeneracion"/>
<!-- 							filterBy="#{parametroTabla.valor}"  filterMatchMode="startsWith" -->
					<p:column headerText="VALOR" style="width:40%;text-align:center;"  >
						<p:cellEditor>
							<f:facet name="output">
								<p:outputLabel value="#{parametroTabla.valor}"></p:outputLabel>
							</f:facet>
							<f:facet name="input" style="width:100%;">
								<p:inputText value="#{parametroTabla.valor}" required="true" minlength="1" maxlength="250" style="width:100%" 
								 	styleClass="#{bMantenimientoTablas.mMantenimientoTablas.mayuscula}"
								 validatorMessage="Debe ingresar valores validos" requiredMessage="Debe ingresar un Valor">
									<f:validator validatorId="extendedRegexValidator" />
   									<f:attribute name="pattern" value="#{bMantenimientoTablas.mMantenimientoTablas.patron}" />
								</p:inputText>
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="DESCRIPCION" style="width:35%;text-align:center;">
						<p:cellEditor>
							<f:facet name="output">
								<p:outputLabel value="#{empty parametroTabla.aux3? '-': parametroTabla.aux3}"></p:outputLabel>
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{parametroTabla.aux3}" styleClass="Mayuscula" minlength = "1" maxlength="250"  style="width:100%">
								</p:inputText>
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="ESTADO" rendered="#{(not empty bMantenimientoTablas.mMantenimientoTablas.tablaSeleccionada and bMantenimientoTablas.mMantenimientoTablas.activarAgregar eq '1' ? true:false)}">
						<p:cellEditor>
							<f:facet name="output">
								<p:outputLabel value ="#{parametroTabla.valorEstado}"></p:outputLabel>
							</f:facet>
							<f:facet name="input">
								<h:selectOneMenu value="#{parametroTabla.estado}" style="width:100%;">
									<f:selectItems value="#{bMantenimientoTablas.listaEstados}" var="estado" itemValue="#{estado.cregistro}" itemLabel="#{estado.valor}">
									</f:selectItems>
								</h:selectOneMenu>
							</f:facet>
						</p:cellEditor>
					</p:column>
				
					<p:column headerText="VALORES PERMITIDOS (COLUMNA VALOR)" style="width:10%;text-align:center;">
						<p:outputLabel value="#{parametroTabla.aux1}"></p:outputLabel>
					</p:column>
				
					<p:column headerText="EDITAR" style="width:5%;text-align:center;">
						<p:rowEditor />
					</p:column>			
					
				</p:dataTable>
				
				<p:dialog header="Nuevo Registro" widgetVar="dlg1" minHeight="70" minWidth="320"  id="dialogMantenimientoTablas" >
    				<h:panelGrid columns="2" styleClass="panelOtros dialogPanelGrid" rowspan="2" id="panelDialog"  cellspacing="9">
    					<p:outputLabel value="Valor *"></p:outputLabel>
    					<p:inputText id="nuevoValor" value="#{bMantenimientoTablas.mMantenimientoTablas.valorNuevo}"  required="true" minlength="1" maxlength="250" style="width:95%"
    					 			styleClass="#{bMantenimientoTablas.mMantenimientoTablas.mayuscula}" 
								 validatorMessage="Debe ingresar valores validos" requiredMessage="Debe ingresar un Valor">
								<f:validator validatorId="extendedRegexValidator" />
   								<f:attribute name="pattern" value="#{bMantenimientoTablas.mMantenimientoTablas.patron}"/>
						</p:inputText>
						<p:outputLabel value="Descripcion "></p:outputLabel>
						<p:inputTextarea styleClass="Mayuscula" value="#{bMantenimientoTablas.mMantenimientoTablas.descripcion}" style="width:95%"></p:inputTextarea>
						
    					<p:outputLabel value="Estado *"></p:outputLabel>
    					<p:selectOneMenu value="#{bMantenimientoTablas.mMantenimientoTablas.estadoNuevo}" id="estado" required="true"    					
										requiredMessage="Debe seleccionar un Estado">
    					   	<f:selectItem itemValue="#{null}" itemLabel="SELECCIONE UN ESTADO"></f:selectItem>
    					  	<f:selectItems value="#{bMantenimientoTablas.listaEstados}" var="nEstados"
    										itemLabel="#{nEstados.valor}" itemValue="#{nEstados.cregistro}"></f:selectItems>
    					</p:selectOneMenu>
    					
    					<p:tooltip id="toolNuevoValor" rendered="#{ not empty facesContext.messageList }"  for="nuevoValor">
                                        	        <p:message for="nuevoValor" />
                                 		</p:tooltip>
    					
    					<p:tooltip id="toolEstado" rendered="#{ not empty facesContext.messageList }"  for="estado">
                                        	        <p:message for="estado" />
                                 		</p:tooltip>
    					
    					<f:facet name="footer">
    						<div align="center">
    							<p:commandButton value="Agregar" action="#{bMantenimientoTablas.insertarParametro}"
    							 update=":formTablas:msjGeneracion2 :formTablas:tablaParametro1 panelDialog" ></p:commandButton>
    						</div>
    					</f:facet>
    				</h:panelGrid>
				</p:dialog>
			</p:panel>

		</h:form>
	
	</ui:define>
</ui:composition>